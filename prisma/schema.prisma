generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum UserRole {
  ADMIN
  MANAGER
}

enum CallDirection {
  INBOUND
  OUTBOUND
}

enum CallStatus {
  COMPLETED
  MISSED
  FAILED
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String
  name         String
  role         UserRole @default(MANAGER)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model MenuItem {
  id          String   @id @default(cuid())
  name        String
  category    String
  description String
  price       Decimal  @db.Decimal(10, 2)
  imageUrl    String?
  available   Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([available])
}

model CallLog {
  id            String        @id @default(cuid())
  customerName  String
  phone         String
  direction     CallDirection
  status        CallStatus
  duration      Int           @default(0)
  timestamp     DateTime
  recordingUrl  String?
  transcription String
  orderSummary  String?
  aiConfidence  Float?
  createdAt     DateTime      @default(now())

  @@index([timestamp])
  @@index([phone])
  @@index([status])
}
